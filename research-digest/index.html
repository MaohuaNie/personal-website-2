<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Research Digest | Maohua Nie</title>
  <meta name="description" content="Archive of automated research digests" />
  <link rel="stylesheet" href="/assets/site.css" />
  <link rel="icon" href="/favicon.svg" />

  <style>
    html, body {
      height: 100%;
    }

    /* ===== Layout ===== */
    .digest-layout {
      display: grid;
      grid-template-columns: 280px 1fr;
      height: 100vh;
      background: #ffffff;
    }

    /* ===== Sidebar ===== */
    .digest-sidebar {
      height: 100vh;
      overflow-y: auto;
      overflow-x: hidden;
      padding: 18px 16px;
      background: linear-gradient(180deg, #f8fafc 0%, #ffffff 100%);
      border-right: 1px solid #e5e7eb;
      -webkit-overflow-scrolling: touch;
    }

    .digest-sidebar::-webkit-scrollbar {
      width: 8px;
    }
    .digest-sidebar::-webkit-scrollbar-thumb {
      background: rgba(0,0,0,0.15);
      border-radius: 6px;
    }

    /* ===== Header ===== */
    .digest-header {
      display: flex;
      flex-direction: column;
      gap: 14px;
      margin-bottom: 18px;
    }

    .digest-header-text h1 {
      font-size: 22px;
      margin: 0;
      font-weight: 700;
      color: #111827;
    }

    .digest-header-text p {
      margin: 4px 0 0;
      color: #6b7280;
      font-size: 13px;
      line-height: 1.4;
    }

    .digest-divider {
      height: 1px;
      background: linear-gradient(to right, #e5e7eb, transparent);
      margin: 16px 0;
    }

    /* ===== Back to Home ===== */
    .home-button {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      width: 100%;
      padding: 14px;
      background: linear-gradient(
        135deg,
        rgba(7, 69, 135, 0.95),
        rgba(0, 75, 122, 0.95)
      );
      color: #ffffff;
      font-size: 18px;
      font-weight: 600;
      border-radius: 14px;
      text-decoration: none;
      box-shadow:
        0 6px 18px rgba(0,0,0,.18),
        inset 0 1px 0 rgba(255,255,255,.08);
    }

    /* ===== Digest navigation ===== */
    .digest-nav {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .digest-year {
      margin: 18px 0 6px;
      padding-left: 6px;
      font-size: 16px;
      font-weight: 700;
      color: #111827;
      pointer-events: none;
      user-select: none;
    }

    .digest-nav li {
      margin: 10px 0;
    }

    .digest-link {
      display: block;
      padding: 14px;
      border-radius: 14px;
      border: 1px solid #e5e7eb;
      background: #ffffff;
      color: #111827;
      cursor: pointer;
      text-decoration: none;
      transition: all .15s ease;
    }

    .digest-link:hover {
      background: #f9fafb;
      box-shadow: 0 6px 18px rgba(0,0,0,0.06);
    }

    .digest-link.active {
      background: #eef2ff;
      border-left: 4px solid #1e3a8a;
      padding-left: 10px;
      box-shadow: 0 4px 14px rgba(0,0,0,0.08);
    }

    .digest-title {
      font-size: 14px;
      font-weight: 600;
    }

    .digest-description {
      font-size: 13px;
      line-height: 1.5;
      color: #4b5563;
      background: #f9fafb;
      border: 1px solid #e5e7eb;
      border-radius: 12px;
      padding: 12px 14px;
    }

    .digest-description p {
      margin: 0 0 8px;
    }

    .digest-description p:last-child {
      margin-bottom: 0;
    }

    .digest-disclaimer {
      font-size: 12px;
      color: #6b7280;
    }

    /* ===== Content ===== */
    .digest-content {
      height: 100vh;
      overflow: hidden;
      background: #f6f7fb;
    }

    #digest-frame {
      width: 100%;
      height: 100%;
      border: none;
    }

    /* ===== Mobile ===== */
    @media (max-width: 900px) {
      .digest-layout {
        grid-template-columns: 1fr;
        height: auto;
      }

      .digest-sidebar {
        max-height: 45vh;
        overflow-y: auto;
        border-right: none;
        border-bottom: 1px solid #e5e7eb;
      }

      .digest-content {
        height: calc(100vh - 45vh);
      }
    }
  </style>
</head>

<body>
  <div class="digest-layout">
    <aside class="digest-sidebar">
      <div class="digest-header">
        <a href="/" class="home-button">← Back to Home</a>

        <div class="digest-header-text">
          <h1>Research Digest</h1>
          <p>Bi-monthly research digests (1st &amp; 15th)</p>
        </div>
        <div class="digest-description">
        <p>
          This page presents a bi-monthly, automatically generated research digest
          covering recent publications in decision making, psychology, and related fields.
          Papers are collected from selected journals, ranked using semantic similarity,
          and summarized using large language models.
        </p>

        <p class="digest-disclaimer">
          All articles and abstracts remain the property of their respective authors
          and publishers. Summaries and relevance scores are generated automatically
          using the OpenAI API and may be imperfect. Please consult the original papers
          for authoritative information.
        </p>
      </div>
      </div>

      <div class="digest-divider"></div>

      <ul id="digest-nav" class="digest-nav">
        <li>Loading…</li>
      </ul>
    </aside>

    <main class="digest-content">
      <iframe id="digest-frame" title="Digest Viewer"></iframe>
    </main>
  </div>

  <script>
    function setActive(linkEl) {
      document.querySelectorAll(".digest-link")
        .forEach(a => a.classList.remove("active"));
      linkEl.classList.add("active");
    }

    function formatDigestTitle(dateStr) {
      const d = new Date(dateStr + "T00:00:00");
      const month = d.toLocaleString("en-US", { month: "short" });
      const day = d.getDate();

      if (day === 15) return `Early ${month}`;
      if (day === 1) {
        const prev = new Date(d);
        prev.setDate(0);
        const prevMonth = prev.toLocaleString("en-US", { month: "short" });
        return `Late ${prevMonth}`;
      }
      return dateStr;
    }

    fetch("digests.json")
      .then(r => r.json())
      .then(digests => {
        const nav = document.getElementById("digest-nav");
        const frame = document.getElementById("digest-frame");
        nav.innerHTML = "";

        const ordered = digests
          .slice()
          .sort((a, b) => new Date(b.date) - new Date(a.date));

        let lastYear = null;

        ordered.forEach((d, i) => {
          const year = new Date(d.date + "T00:00:00").getFullYear();

          if (year !== lastYear) {
            const y = document.createElement("li");
            y.className = "digest-year";
            y.textContent = year;
            nav.appendChild(y);
            lastYear = year;
          }

          const li = document.createElement("li");
          const a = document.createElement("a");
          a.className = "digest-link";
          a.innerHTML = `<div class="digest-title">${formatDigestTitle(d.date)}</div>`;

          a.onclick = e => {
            e.preventDefault();
            frame.src = d.file;
            setActive(a);
          };

          li.appendChild(a);
          nav.appendChild(li);

          if (i === 0) {
            frame.src = d.file;
            setActive(a);
          }
        });
      });
  </script>
</body>
</html>